---
title: "a3_task3_renee_lamanna"
author: "Renee LaManna"
date: "10/27/2021"
output: html_document
---

### Setup

- Attatching packages
- Set codechunk options

```{r setup, include = TRUE, warnings = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

library (tidyverse)
library (here)
library (janitor)
library (kableExtra)
library (DT)
library (lubridate)

```

### Read in Data

- urchins.csv = file containing data for red and purple urchins observed at 5 sites along the Santa Barbara coast

```{r}
# Read in urchins.csv as `urchins`
urchins <- read_csv(here("data", "urchins.csv"))
```

### Data cleaning

- Using clean_names(), create a new dataset, `urchins_clean` that is converted to lowersnakecase

```{r}
urchins_clean <- urchins %>% 
  clean_names()
```

# Section 1:

### Data Visualization

- Create histogram comparing distribution of sizes between purple and red urchins
- Use urchins_clean as data and indicate size on the x-axis, the y-axis will automatically be count
- Use geom_historgam() to indicate type of graph and set bin size to 10
- Use facet_wrap() fxn to organize purple and red urchins into separate graphs
- Added theme_minimal(), renames axis, added title, subtitle, and caption all with labs()

```{r}
ggplot(data = urchins_clean, aes(x = size)) +
  geom_histogram(aes(fill = common_name), bins = 10) +
  facet_wrap(~common_name) +
  theme_minimal() +
  theme(axis.title.x = element_text(hjust = 0.5, vjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        plot.caption = element_text(hjust = .2),
        legend.position = "none") +
  labs( x = "Urchin diameter (cm)", 
        y = "Number of urchins",
        title = "Urchin diameter distribution for purple and red urchins",
        subtitle = "Santa Barbara, CA",
        caption = "Figure 1. Size distribution, represented as urchin diameter (cm) for both purple and red urchins at 5 different sites along Santa Barbara coast")
```

Descriptive statistics table: Create a finalized summary table that contains the following statistics for purple and red urchins (still ignoring site as a variable, but including species as a grouping variable): mean, median, standard deviation, and sample size. Use kableExtra (or another package for tables in R) to finalize your table for your knitted document. Add a table caption above your table. Some things to consider:
Are the values a reasonable number of significant figures?
Have you updated column names to be finalized (with units?)

### Summary Statistics 

```{r}
urchins_summary <- urchins_clean %>% 
  group_by(common_name) %>% 
  summarise(mean = round(mean(size), 2), 
            median = median(size), 
            sd = round(sd(size), 2), 
            count = n())
 
kable(urchins_summary) %>% 
  kable_styling(full_width = FALSE,
                bootstrap_options = "hover",
                position = "left") 
  
```

Below where your graph and table appear, add 2 - 3 sentences briefly describing your overall takeaways about how the size (distribution, central tendency, spread, etc.) compare between the two species of urchins (again, here we are ignoring site and treatment as a variable). Help to contextualize any differences you observe - for example, what is the actual and % difference in mean urchin diameter between the species? 

# Section 2 

### Data Wrangling



```{r}
purple_urchins <- urchins_clean %>% 
  filter(common_name == "Purple Urchin") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date)) %>% 
  mutate(site_full = case_when(site == "NAPL" ~ "Naples Reef",
                               site == "AQUE" ~ "Arroyo Quemado",
                               site == "CARP" ~ "Carpinteria Reef",
                               site == "MOHK" ~ "Mohawk Reef",
                               site == "IVEE" ~ "Isla Vista Reef"))
```

Write code to store a table containing the total number of purple urchins observed by site and year. You do not need to finalize this table and it does not need to appear in your knitted document (youâ€™ll just use the output in a plot in the next step).

### Table of purple urchins observed by site and year

```{r}
total_purple_urchins <- purple_urchins %>% 
  group_by(site_full, year) %>% 
  summarise(count=n())

total_purple_urchins
```

Make a finalized graph of counts of purple urchins recorded at each site over time for the years included in the study. Add a figure caption.
Add text below your graph: do you think this graph reflects changes in the purple urchin population? What would you have to take into account to determine whether the changes in counts by year are reflective of actual changes in urchin population? What else could explain the changes in number of purple urchins observed? 

### Data Visualization

```{r}
ggplot(data = total_purple_urchins, aes(x = year, y = count)) + 
  geom_col(aes(color = site_full, fill = site_full)) +
  facet_wrap(~site_full) +
  scale_color_manual(values = c("white", "white", "white", "white", "white")) +
  scale_fill_manual(values = c("green", "orange", "pink", "blue", "purple")) +
  theme_gray() +
  theme(axis.title.x = element_text(hjust = 0.5, vjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 60, size = 6),
        legend.position = "none") +
 labs( x = "Year", 
        y = "Number of urchins",
        title = "Number of Purple Urchins per Site (LAMANNA)",
        subtitle = "2008-2020",
        caption = "Figure 1. Size distribution, represented as urchin diameter (cm) for both purple and red urchins at 5 different sites along Santa Barbara coast")
```


